<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
  <title>Ø´Ø§Ø´Ø© Ø§Ù„Ø²ÙŠØ§Ø±Ø© â€” ØªØµÙ…ÙŠÙ… Ø¬Ù…Ø§Ù„ÙŠ (Ù†Ø³Ø®Ø© Ù…Ø­Ø¯Ø«Ø©)</title>
  <style>
    :root{
      --bg:#f9fafc; --surface:#ffffff; --text:#0f172a; --muted:#64748b; --line:#e2e8f0;
      --primary:#2563eb; --success:#16a34a; --warn:#f59e0b; --danger:#ef4444;
      --radius-xl:18px; --radius-lg:14px; --radius:12px; --pad:16px;
      --chip:#f1f5f9; --shadow: 0 8px 24px rgba(37,99,235,.08);
    }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,#f8fafc,#f4f6fa);color:var(--text);font:15.5px/1.7 'Cairo',system-ui,-apple-system,"Segoe UI",Roboto,Arial}
    .container{max-width:1200px;margin:0 auto;padding:20px}

    /* Topbar */
    .topbar{position:sticky;top:0;z-index:50;backdrop-filter:blur(10px) saturate(140%);background:rgba(255,255,255,.9);border-bottom:1px solid var(--line)}
    .topbar-inner{display:flex;justify-content:space-between;align-items:center;padding:12px 20px}
    .brand{display:flex;align-items:center;gap:12px}
    .avatar{width:42px;height:42px;border-radius:50%;display:grid;place-items:center;background:linear-gradient(135deg,#3b82f6,#2563eb);color:#fff;font-weight:800;box-shadow:0 4px 10px rgba(37,99,235,.25)}
    .actions{display:flex;gap:10px}
    .btn{appearance:none;border:none;cursor:pointer;border-radius:var(--radius);padding:10px 14px;font-weight:800;background:#ffffff;color:#0f172a;border:1px solid #e2e8f0;box-shadow:0 6px 14px rgba(15,23,42,.06);transition:.2s}
    .btn:hover{transform:translateY(-1px);box-shadow:0 10px 20px rgba(15,23,42,.1)}
    .btn.primary{background:linear-gradient(135deg,#3b82f6,#2563eb);border:0;color:#fff;box-shadow:0 8px 18px rgba(37,99,235,.25)}

    /* Tabs */
    .tabs{display:flex;gap:10px;flex-wrap:wrap;border-bottom:1px solid transparent;padding-bottom:8px}
    .tab-btn{background:#ffffff;border:1px solid var(--line);color:var(--muted);padding:10px 16px;border-radius:14px;cursor:pointer;box-shadow:0 6px 14px rgba(15,23,42,.06);transition:transform .15s ease, box-shadow .15s ease, color .2s ease}
    .tab-btn:hover{transform:translateY(-1px);box-shadow:0 10px 20px rgba(15,23,42,.1);color:#0f172a}
    .tab-btn[aria-selected="true"]{color:#0f172a;background:#eef4ff;border:1px solid #c7d2fe;box-shadow:0 8px 18px rgba(37,99,235,.12)}
    .tabpanels{padding-top:16px}
    .tabpanel{display:none}
    .tabpanel[aria-hidden="false"]{display:block;animation:fadeIn .35s ease}
    @keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}

    /* Cards */
    .card{background:#fff;border:1px solid var(--line);border-radius:var(--radius-xl);box-shadow:var(--shadow);overflow:hidden}
    .card .head{display:flex;justify-content:space-between;align-items:center;padding:14px 18px;background:linear-gradient(90deg,#f8fafc,#f1f5f9);border-bottom:1px solid var(--line)}
    .card .head h3{margin:0;font-size:1rem;color:var(--primary);position:relative;padding-inline-start:12px}
    .card .head h3::before{content:"";position:absolute;inset-inline-start:0;top:6px;width:6px;height:18px;border-radius:6px;background:linear-gradient(180deg,#60a5fa,#2563eb)}
    .card .body{padding:18px}

    /* Layout */
    .grid{display:grid;grid-template-columns:1.1fr .9fr;gap:16px}
    @media (max-width: 1080px){.grid{grid-template-columns:1fr}}

    /* Form */
    .row{display:grid;grid-template-columns:repeat(12,1fr);gap:12px;margin-bottom:12px}
    .field{display:flex;flex-direction:column;gap:6px;grid-column:span 6}
    .field.third{grid-column:span 4}
    .field.quarter{grid-column:span 3}
    .field.full{grid-column:1/-1}
    label{color:#0f172a;font-weight:800;font-size:13.5px;letter-spacing:.1px}
    input,select,textarea{width:100%;padding:12px;border-radius:14px;background:#fff;border:1px solid #d1d9e6;color:#0f172a;outline:none;box-shadow:inset 0 1px 0 rgba(255,255,255,.6), 0 0 0 rgba(0,0,0,0);transition:border-color .2s, box-shadow .2s}
    textarea{min-height:96px;resize:vertical}
    input:focus,select:focus,textarea:focus{border-color:#93c5fd;box-shadow:0 0 0 4px rgba(37,99,235,.12), inset 0 1px 0 rgba(255,255,255,.6)}

    /* Chips */
    .chip{display:inline-flex;align-items:center;gap:6px;background:var(--chip);border:1px solid #e2e8f0;color:#0f172a;border-radius:999px;padding:6px 12px;font-size:13px;font-weight:700}
    .hint{color:var(--muted);font-size:13px}

    /* Uploader */
    .uploader{border:2px dashed #cbd5e1;border-radius:14px;padding:20px;background:#f9fafc;text-align:center;color:#64748b;transition:.3s}
    .uploader:hover{background:#f1f5f9;color:#334155}

    /* Table */
    table{width:100%;border-collapse:collapse;font-size:14px}
    th,td{border-bottom:1px solid #e2e8f0;padding:10px;text-align:right}
    th{color:#334155;background:#f9fafc;font-weight:800}

    /* Totals */
    .totals{display:grid;gap:8px;border-top:1px dashed var(--line);padding-top:12px;margin-top:8px}
    .totals .line{display:flex;justify-content:space-between}
    .grand{font-size:18px;font-weight:800;color:var(--primary)}

    /* Skin type cards */
    .skin-types{display:grid;grid-template-columns:repeat(6,1fr);gap:10px}
    .skin-card{display:flex;flex-direction:column;align-items:center;gap:8px;padding:10px;border:2px solid #e2e8f0;border-radius:14px;background:#fff;cursor:pointer;transition:.2s}
    .skin-card:hover{transform:translateY(-1px);box-shadow:0 8px 18px rgba(15,23,42,.06)}
    .skin-card.active{border-color:#2563eb;background:#eff6ff;box-shadow:0 0 0 3px rgba(37,99,235,.15)}
    .skin-chip{font-weight:800;color:#0f172a}

    /* Anim */
    .svc-item,.lab-item{transition:transform .2s,box-shadow .2s}
    .svc-item:hover,.lab-item:hover{transform:translateY(-2px);box-shadow:0 4px 14px rgba(0,0,0,.05)}

    @media print{.no-print{display:none!important} body{background:#fff;color:#000} .card{box-shadow:none}}
    /* Enhanced Skin Types visuals */
    .skin-types{display:grid;grid-template-columns:repeat(6,1fr);gap:10px}
    .skin-card{display:flex;flex-direction:column;align-items:center;gap:8px;padding:12px;border:2px solid #e2e8f0;border-radius:16px;background:#fff;cursor:pointer;transition:.22s;box-shadow:0 6px 14px rgba(15,23,42,.06)}
    .skin-card:hover{transform:translateY(-2px);box-shadow:0 10px 22px rgba(15,23,42,.1)}
    .skin-card.active{border-color:#2563eb;box-shadow:0 0 0 4px rgba(37,99,235,.14), 0 12px 26px rgba(15,23,42,.12)}
    .skin-swatch{width:40px;height:40px;border-radius:999px;box-shadow:inset 0 2px 0 rgba(255,255,255,.75);border:1px solid #e2e8f0}
    .skin-label{font-weight:900;letter-spacing:.3px;color:#0f172a}
    .st1{background:#fdebd4}
    .st2{background:#f6d6b5}
    .st3{background:#e6be9a}
    .st4{background:#c48d62}
    .st5{background:#9b6946}
    .st6{background:#5b3c2d}
    @keyframes pop{0%{transform:scale(0.95)}60%{transform:scale(1.03)}100%{transform:scale(1)}}
    .skin-card.active .skin-swatch{animation:pop .3s ease}
  /* Fitz banner */
    .fitz-banner{display:flex;justify-content:center;margin:8px 0 14px}
    .fitz-banner img{max-width:100%;height:auto;border-radius:12px;border:1px solid var(--line);box-shadow:0 6px 14px rgba(15,23,42,.06)}
  /* Tooltips & type-colored active states */
    .skin-card{position:relative}
    .skin-card:hover::after{content:attr(data-tip);position:absolute;bottom:-30px;right:50%;transform:translateX(50%);background:#334155;color:#fff;font-size:12px;padding:6px 8px;border-radius:8px;white-space:nowrap;box-shadow:0 6px 14px rgba(15,23,42,.12)}
    .skin-card[data-value="I"].active{background:#fdebd4}
    .skin-card[data-value="II"].active{background:#f6d6b5}
    .skin-card[data-value="III"].active{background:#e6be9a}
    .skin-card[data-value="IV"].active{background:#c48d62;color:#fff}
    .skin-card[data-value="V"].active{background:#9b6946;color:#fff}
    .skin-card[data-value="VI"].active{background:#5b3c2d;color:#fff}
  /* Fitz banner */
    .fitz-banner{display:flex;justify-content:center;margin:8px 0 14px}
    .fitz-banner img{max-width:100%;height:auto;border-radius:12px;border:1px solid var(--line);box-shadow:0 6px 14px rgba(15,23,42,.06)}

    /* Active coloring */
    .skin-card[data-value="I"].active{background:#fdebd4}
    .skin-card[data-value="II"].active{background:#f6d6b5}
    .skin-card[data-value="III"].active{background:#e6be9a}
    .skin-card[data-value="IV"].active{background:#c48d62;color:#fff}
    .skin-card[data-value="V"].active{background:#9b6946;color:#fff}
    .skin-card[data-value="VI"].active{background:#5b3c2d;color:#fff}

    /* Tooltip */
    .skin-card{position:relative}
    .skin-card:hover::after{
      content:attr(data-tip);
      position:absolute;bottom:-32px;right:50%;transform:translateX(50%);
      background:#334155;color:#fff;font-size:12px;padding:4px 8px;border-radius:8px;white-space:nowrap;box-shadow:0 4px 10px rgba(0,0,0,.2)
    }
  /* Multi chips (body locations) */
    .multi-chips{display:flex;flex-wrap:wrap;gap:8px;margin-top:6px}
    .chip.selectable{cursor:pointer;user-select:none;transition:.18s}
    .chip.selectable:hover{transform:translateY(-1px);box-shadow:0 8px 18px rgba(15,23,42,.08)}
    .chip.selectable.active{background:#e0f2fe;border-color:#93c5fd;color:#0c4a6e;box-shadow:0 0 0 3px rgba(59,130,246,.18)}

  /* Smaller skin swatches */
    .skin-swatch{width:32px;height:32px;border-radius:999px;box-shadow:inset 0 2px 0 rgba(255,255,255,.75);border:1px solid #e2e8f0}
  /* Body map */
    .bodymap-controls{display:flex;gap:8px;margin:6px 0}
    .bm-toggle.active{outline:2px solid #93c5fd}
    .bodymap{display:grid;grid-template-columns:1fr 1fr;gap:12px;align-items:center;justify-items:center;background:#f8fafc;border:1px solid var(--line);border-radius:14px;padding:10px}
    .figure{width:100%;max-width:320px}
    .figure .area{fill:rgba(37,99,235,.08);stroke:#334155;stroke-width:1.5;opacity:.6;transition:.18s;cursor:pointer}
    .figure .area:hover{opacity:1}
    .figure .area.active{fill:rgba(37,99,235,.22);opacity:1;filter:drop-shadow(0 4px 8px rgba(37,99,235,.18))}
    .figure .area.active circle,.figure .area.active rect{animation:bm-pop .28s ease}
    @keyframes bm-pop{0%{transform:scale(.96)}60%{transform:scale(1.04)}100%{transform:scale(1)}}
    @media (max-width:900px){.bodymap{grid-template-columns:1fr}}
/* BodyPicker (image + hotspots) */
    .bodypicker{
        position:relative;width:100%;aspect-ratio:3/5.6;
        border:1px solid var(--line);border-radius:14px;
        background:#EAF4FF;overflow:hidden
        }
    .bodypicker .bp-canvas{position:absolute;inset:0;background-size:contain;background-repeat:no-repeat;background-position:center;filter:drop-shadow(0 6px 14px rgba(15,23,42,.06))}
    .bodypicker[data-view="front"] .bp-canvas{background-image:url('https://api.cefour.com/storage/image/human-anatomy-hand-drawn-vector-illustrations-set-male-body_(2)_(1)_68bb9c86797bc.jpg')}
    .bodypicker[data-view="back"]  .bp-canvas{background-image:url('https://api.cefour.com/storage/image/human-anatomy-hand-drawn-vector-illustrations-set-male-body_(2)_(1)_68bb9c86797bc.jpg')}
    .bodypicker-controls{display:flex;gap:8px;margin:6px 0}
    .bp-toggle.active{outline:2px solid #93c5fd}
    .bp-spot{position:absolute;transform:translate(-50%,-50%);width:34px;height:34px;border-radius:50%;background:rgba(37,99,235,.08);border:2px solid rgba(37,99,235,.35);cursor:pointer;display:grid;place-items:center;transition:transform .15s, box-shadow .15s, background .15s, border-color .15s}
    .bp-spot::after{content:"";width:14px;height:14px;border-radius:50%;background:rgba(37,99,235,.45)}
    .bp-spot:hover{transform:translate(-50%,-50%) scale(1.06);box-shadow:0 8px 18px rgba(37,99,235,.18)}
    .bp-spot.active{background:rgba(37,99,235,.28);border-color:#2563eb}
    .bp-spot.active::after{background:#2563eb}
    .bp-spot[data-tip]:hover::before{content:attr(data-tip);position:absolute;top:-10px;transform:translate(-50%,-100%);background:#334155;color:#fff;font-size:12px;padding:4px 8px;border-radius:8px;white-space:nowrap}

</style>
</head>
<body>
  <header class="topbar">
    <div class="topbar-inner container">
      <div class="brand"><div class="avatar">Ø¯</div><div><div style="font-weight:900">Ø´Ø§Ø´Ø© Ø§Ù„Ø²ÙŠØ§Ø±Ø© â€” Ø¯ÙƒØªÙˆØ± Ø¬Ù„Ø¯ÙŠØ©</div><small style="color:var(--muted)">Ø§Ù„Ù…Ø±ÙŠØ¶: ÙØ§Ø·Ù…Ø© Ø­Ø³Ù† â€¢ Ø§Ù„ÙŠÙˆÙ… 14:30 â€¢ Ø¯. Ø£Ø­Ù…Ø¯</small></div></div>
      <div class="actions no-print">
        <button class="btn">Ø­ÙØ¸ Ù…Ø³ÙˆØ¯Ø©</button>
        <button class="btn primary">Ø­ÙØ¸ Ø§Ù„Ø²ÙŠØ§Ø±Ø©</button>
      </div>
    </div>
  </header>

  <main class="container">
    <!-- Tabs -->
    <div class="tabs" role="tablist" aria-label="Visit Tabs">
      <button class="tab-btn" role="tab" id="tab-basic" aria-controls="panel-basic" aria-selected="true">Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</button>
      <button class="tab-btn" role="tab" id="tab-dx" aria-controls="panel-dx" aria-selected="false">Ø§Ù„ÙƒØ´Ù</button>
      <button class="tab-btn" role="tab" id="tab-rxadv" aria-controls="panel-rxadv" aria-selected="false">Ø§Ù„Ø±ÙˆØ´ØªØ© ÙˆØ§Ù„Ø¥Ø±Ø´Ø§Ø¯Ø§Øª</button>
      <button class="tab-btn" role="tab" id="tab-labs" aria-controls="panel-labs" aria-selected="false">Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„ ÙˆØ§Ù„Ù…Ù„ÙØ§Øª</button>
      <button class="tab-btn" role="tab" id="tab-photos" aria-controls="panel-photos" aria-selected="false">ØµÙˆØ± Ø§Ù„Ø­Ø§Ù„Ø©</button>
      <button class="tab-btn" role="tab" id="tab-billing" aria-controls="panel-billing" aria-selected="false">Ø§Ù„Ø®Ø¯Ù…Ø§Øª ÙˆØ§Ù„ÙÙˆØªØ±Ø©</button>
    </div>

    <div class="tabpanels">
      <!-- Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© -->
      <section id="panel-basic" class="tabpanel" role="tabpanel" aria-labelledby="tab-basic" aria-hidden="false">
        <div class="grid">
          <div class="card">
            <div class="head"><h3>ğŸ§‘ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©</h3><span class="chip">Ù…Ù„Ù #P-10234</span></div>
            <div class="body">
              <div class="row">
                <div class="field third"><label>Ø§Ù„Ø§Ø³Ù…</label><input value="ÙØ§Ø·Ù…Ø© Ø­Ø³Ù†"></div>
                <div class="field quarter"><label>Ø§Ù„Ø¹Ù…Ø± â€” Ø³Ù†ÙˆØ§Øª</label><input type="number" min="0" max="150" value="28"></div>
                <div class="field quarter"><label>Ø§Ù„Ø¹Ù…Ø± â€” Ø´Ù‡ÙˆØ±</label><input type="number" min="0" max="11" value="0"></div>
                <div class="field quarter"><label>Ø§Ù„Ù†ÙˆØ¹</label><select><option>Ø£Ù†Ø«Ù‰</option><option>Ø°ÙƒØ±</option></select></div>
                <div class="field quarter"><label>Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø§Ø¬ØªÙ…Ø§Ø¹ÙŠØ©</label><select><option>Ø£Ø¹Ø²Ø¨/Ø¹Ø²Ø¨Ø§Ø¡</option><option>Ù…ØªØ²ÙˆØ¬/Ø©</option><option>Ø£Ø®Ø±Ù‰</option></select></div>
                <div class="field third"><label>Ø§Ù„Ù…Ù‡Ù†Ø©</label><input placeholder="Ù…Ø«Ø§Ù„: Ù…ÙØ¯Ø±Ù‘Ø³Ø©"></div>
                <div class="field third"><label>Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</label><input placeholder="Ø§Ù„Ù‚Ø§Ù‡Ø±Ø©ØŒ Ø§Ù„Ù…Ù‡Ù†Ø¯Ø³ÙŠÙ†â€¦"></div>
                <div class="field third"><label>Ø±Ù‚Ù… Ø§Ù„ØªÙ„ÙŠÙÙˆÙ†</label><input type="tel" placeholder="01xxxxxxxxx"></div>
                <div class="field full"><label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø£Ø®Ø±Ù‰</label><input placeholder="Ø£ÙŠ Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©â€¦"></div>
              </div>
            </div>
          </div>

          <aside class="card">
            <div class="head"><h3>âš•ï¸ Ø§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…Ø±Ø¶ÙŠ</h3></div>
            <div class="body">
              <div class="row">
                <div class="field quarter"><label>Ø³ÙƒØ±</label><select><option>Ù„Ø§</option><option>Ù†Ø¹Ù…</option></select></div>
                <div class="field quarter"><label>Ø¶ØºØ·</label><select><option>Ù„Ø§</option><option>Ù†Ø¹Ù…</option></select></div>
                <div class="field quarter"><label>Ø­Ø³Ø§Ø³ÙŠØ© Ø£Ø¯ÙˆÙŠØ©</label><select><option>Ù„Ø§</option><option>Ù†Ø¹Ù…</option></select></div>
                <div class="field quarter"><label>Ø­Ù…Ù„</label><select><option>Ù„Ø§</option><option>Ù†Ø¹Ù…</option></select></div>
                <div class="field quarter"><label>Ø±Ø¶Ø§Ø¹Ø©</label><select><option>Ù„Ø§</option><option>Ù†Ø¹Ù…</option></select></div>
                <div class="field full"><label>Ø£Ù…Ø±Ø§Ø¶ Ø£Ø®Ø±Ù‰</label><input placeholder="Ù…Ø«Ø§Ù„: Ø±Ø¨ÙˆØŒ Ù‚Ù„Ø¨â€¦"></div>
                              <div class="field full"><label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø£Ø®Ø±Ù‰</label><input placeholder="ØªÙØ§ØµÙŠÙ„ Ø¥Ø¶Ø§ÙÙŠØ©â€¦"></div>
              </div>
            </div>
          </aside>
        </div>
      </section>

      <!-- Ø§Ù„ÙƒØ´Ù ÙˆØ§Ù„Ø±ÙˆØ´ØªØ© -->
      <section id="panel-dx" class="tabpanel" role="tabpanel" aria-labelledby="tab-dx" aria-hidden="true">
        <div class="card">
          <div class="head"><h3>ğŸ©º Ø§Ù„ÙƒØ´Ù</h3></div>
          <div class="body">
            <!-- First: fields moved here per request -->
            <div class="row">
              <div class="field full">
                <label>Ù†ÙˆØ¹ Ø§Ù„Ø¨Ø´Ø±Ø© (Fitzpatrick)</label>

                <div class="skin-types" id="skinTypes">
                  <div class="skin-card" data-value="I" data-tip="Type I: Ø¨Ø´Ø±Ø© ÙØ§ØªØ­Ø© Ø¬Ø¯Ù‹Ø§ØŒ ØªØ­ØªØ±Ù‚ Ø¯Ø§Ø¦Ù…Ù‹Ø§ØŒ Ù„Ø§ ØªØ³Ù…Ø±">
                    <div class="skin-swatch st1"></div>
                    <div class="skin-label">Type I</div>
                  </div>
                  <div class="skin-card" data-value="II" data-tip="Type II: ÙØ§ØªØ­Ø©ØŒ ØºØ§Ù„Ø¨Ù‹Ø§ ØªØ­ØªØ±Ù‚ØŒ Ù‚Ø¯ ØªØ³Ù…Ø± Ù‚Ù„ÙŠÙ„Ù‹Ø§">
                    <div class="skin-swatch st2"></div>
                    <div class="skin-label">Type II</div>
                  </div>
                  <div class="skin-card" data-value="III" data-tip="Type III: Ù…ØªÙˆØ³Ø·Ø©ØŒ Ø£Ø­ÙŠØ§Ù†Ù‹Ø§ ØªØ­ØªØ±Ù‚ØŒ ØªØ³Ù…Ø± ØªØ¯Ø±ÙŠØ¬ÙŠÙ‹Ø§">
                    <div class="skin-swatch st3"></div>
                    <div class="skin-label">Type III</div>
                  </div>
                  <div class="skin-card" data-value="IV" data-tip="Type IV: Ù‚Ù…Ø­ÙŠØ©ØŒ Ù†Ø§Ø¯Ø±Ù‹Ø§ Ù…Ø§ ØªØ­ØªØ±Ù‚ØŒ ØªØ³Ù…Ø± Ø¨Ø³Ù‡ÙˆÙ„Ø©">
                    <div class="skin-swatch st4"></div>
                    <div class="skin-label">Type IV</div>
                  </div>
                  <div class="skin-card" data-value="V" data-tip="Type V: Ø¯Ø§ÙƒÙ†Ø©ØŒ Ù†Ø§Ø¯Ø±Ù‹Ø§ Ø¬Ø¯Ù‹Ø§ ØªØ­ØªØ±Ù‚ØŒ ØªØ³Ù…Ø± Ø¨ÙˆØ¶ÙˆØ­">
                    <div class="skin-swatch st5"></div>
                    <div class="skin-label">Type V</div>
                  </div>
                  <div class="skin-card" data-value="VI" data-tip="Type VI: Ø¯Ø§ÙƒÙ†Ø© Ø¬Ø¯Ù‹Ø§ØŒ Ù„Ø§ ØªØ­ØªØ±Ù‚ ØªÙ‚Ø±ÙŠØ¨Ù‹Ø§ØŒ ØªØ³Ù…Ø± Ù‚ÙˆÙŠ">
                    <div class="skin-swatch st6"></div>
                    <div class="skin-label">Type VI</div>
                  </div>
                </div>
                <input type="hidden" id="skinTypeInput" name="skin_type">
              </div>
              <div class="field third"><label>Ø´ÙƒÙˆÙ‰ Ø±Ø¦ÙŠØ³ÙŠØ©</label><input placeholder="Ø­Ø¨ Ø´Ø¨Ø§Ø¨ â€” Ø­Ø¨ÙˆØ¨ ØªØ­Øª Ø§Ù„Ø¬Ù„Ø¯"></div>
              <div class="field third"><label>Ø´Ø¯Ø© Ø§Ù„Ø£Ø¹Ø±Ø§Ø¶</label>
                <select>
                  <option value="1">1 â€” Ø¨Ø³ÙŠØ·</option>
                  <option value="2">2 â€” Ù…ØªÙˆØ³Ø·</option>
                  <option value="3">3 â€” Ø´Ø¯ÙŠØ¯</option>
                  <option value="4">4 â€” Ø¹Ù†ÙŠÙ Ø¬Ø¯Ù‹Ø§</option>
                </select>
              </div>
              <div class="field third"><label>Ø§Ù„Ù…Ø¯Ø©</label>
                <select>
                  <option>Ø£Ù‚Ù„ Ù…Ù† Ø´Ù‡Ø±</option>
                  <option>Ù…Ù† 1â€“3 Ø´Ù‡ÙˆØ±</option>
                  <option>Ù…Ù† 3â€“6 Ø´Ù‡ÙˆØ±</option>
                  <option>Ù…Ù† 6â€“12 Ø´Ù‡Ø±</option>
                  <option>Ø£ÙƒØ«Ø± Ù…Ù† Ø³Ù†Ø©</option>
                </select>
              </div>
            </div>

            <!-- Body locations (multi-select) -->
            <div class="row">
              <div class="field full">
                <label>Ø§Ù„Ù…ÙƒØ§Ù†</label>
                <div class="bodypicker-controls">
                  <button type="button" class="btn bp-toggle active" data-view="front">Ù…Ù†Ø¸Ø± Ø£Ù…Ø§Ù…ÙŠ</button>
                  <button type="button" class="btn bp-toggle" data-view="back">Ù…Ù†Ø¸Ø± Ø®Ù„ÙÙŠ</button>
                </div>
                <div id="BodyPicker" class="bodypicker" data-view="front" aria-label="Ø®Ø±ÙŠØ·Ø© Ø¬Ø³Ù…">
                  <div class="bp-canvas"></div>
                </div>
                <input type="hidden" id="locationsInput" name="locations">
                <div class="hint" style="margin-top:8px">Ø§Ø®ØªÙŠØ§Ø± Ù…ØªØ¹Ø¯Ø¯: Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙƒØ«Ø± Ù…Ù† Ù…ÙˆØ¶Ø¹. Ø¨Ø¯Ù‘Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ù…Ø§Ù…ÙŠ/Ø§Ù„Ø®Ù„ÙÙŠ Ù…Ù† Ø§Ù„Ø£Ø²Ø±Ø§Ø±.</div>
              </div>
            </div>

            <div class="row">
              <div class="field third"><label>Ø¨Ø¯Ø§ÙŠØ© Ø§Ù„Ù…Ø±Ø¶ (Onset)</label><input placeholder="Ù…Ø«Ø§Ù„: Ù…Ù†Ø° 6 Ø£Ø´Ù‡Ø±"></div>
              <div class="field third"><label>Ù…Ø³Ø§Ø± Ø§Ù„Ù…Ø±Ø¶ (Course)</label><select><option>Ù…Ø³ØªÙ…Ø±</option><option>Ù…ØªØ±Ø¯Ø¯/ÙŠÙ†ØªÙƒØ³</option><option>Ù…ØªØ­Ø³Ù†</option><option>Ù…ØªÙØ§Ù‚Ù…</option></select></div>
              <div class="field third"><label>Ø§Ù„ØªØ´Ø®ÙŠØµ</label><input placeholder="Acne vulgaris â€” Grade 2"></div>
              <div class="field third"><label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø§Ù„ØªØ´Ø®ÙŠØµ</label><input placeholder="PIHØŒ Ù†Ø¯Ø¨Ø§Øª Ø³Ø·Ø­ÙŠØ©â€¦"></div>
              <div class="field third"><label>Ù…ÙˆØ¹Ø¯ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©</label><input type="date"></div>
            </div>
          </div>
        </div>
      </section>

      <!-- Ø§Ù„Ø±ÙˆØ´ØªØ© (ØªØ¨ÙˆÙŠØ¨ Ù…Ø³ØªÙ‚Ù„) -->
      <!-- Ø§Ù„Ø±ÙˆØ´ØªØ© ÙˆØ§Ù„Ø¥Ø±Ø´Ø§Ø¯Ø§Øª (ØªØ¨ÙˆÙŠØ¨ Ù…ÙˆØ­Ù‘Ø¯) -->
      <section id="panel-rxadv" class="tabpanel" role="tabpanel" aria-labelledby="tab-rxadv" aria-hidden="true">
        <div class="card">
          <div class="head"><h3>ğŸ’Š Ø§Ù„Ø±ÙˆØ´ØªØ© & ğŸ’¡ Ø§Ù„Ø¥Ø±Ø´Ø§Ø¯Ø§Øª</h3></div>
          <div class="body">
            <!-- Ù‚ÙˆØ§Ù„Ø¨ Ø§Ù„Ø±ÙˆØ´ØªØ© -->
            <div class="row">
              <div class="field third"><label>Ù‚Ø§Ù„Ø¨ Ø±ÙˆØ´ØªØ©</label>
                <select id="rxTemplate">
                  <option value="">â€” Ø§Ø®ØªØ± Ù‚Ø§Ù„Ø¨Ù‹Ø§ â€”</option>
                  <option value="acne_mild">Acne â€” Mild</option>
                  <option value="acne_moderate">Acne â€” Moderate</option>
                  <option value="pih">Postâ€‘Inflammatory Hyperpigmentation</option>
                </select>
              </div>
              <div class="field quarter"><label>&nbsp;</label><button class="btn" id="btnInsertTemplate">Ø¥Ø¯Ø±Ø§Ø¬ Ø§Ù„Ù‚Ø§Ù„Ø¨</button></div>
            </div>

            <!-- Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø±ÙˆØ´ØªØ© (LTR ÙˆØ§Ù„Ø¯ÙˆØ§Ø¡ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ù…Ø§Ù„) -->
            <div class="table-wrap" style="margin-top:8px">
              <table style="direction:ltr">
                <thead>
                  <tr>
                    <th style="text-align:left">Ø§Ù„Ø¯ÙˆØ§Ø¡</th>
                    <th style="text-align:left">Ø§Ù„ØªØ±ÙƒÙŠØ²</th>
                    <th style="text-align:left">Ø§Ù„Ø¬Ø±Ø¹Ø©</th>
                    <th style="text-align:left">Ø§Ù„ØªÙƒØ±Ø§Ø±</th>
                    <th style="text-align:left">Ø§Ù„Ù…Ø¯Ù‘Ø© (Ø£ÙŠØ§Ù…)</th>
                    <th style="text-align:left">ØªØ¹Ù„ÙŠÙ…Ø§Øª</th>
                  </tr>
                </thead>
                <tbody id="rxTableBody">
                  <tr>
                    <td><input placeholder="Adapalene gel"></td>
                    <td><input placeholder="0.1%"></td>
                    <td><input placeholder="Ø·Ø¨Ù‚Ø© Ø±Ù‚ÙŠÙ‚Ø©"></td>
                    <td><input placeholder="Ù…Ø³Ø§Ø¡Ù‹"></td>
                    <td><input type="number" value="30"></td>
                    <td><input placeholder="Patch test Ø£ÙˆÙ„Ù‹Ø§"></td>
                  </tr>
                </tbody>
              </table>
            </div>

            <!-- ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø±Ø´Ø§Ø¯Ø§Øª + Ù‚ÙˆØ§Ù„Ø¨Ù‡Ø§ -->
            <div class="row" style="margin-top:14px">
              <div class="field quarter"><label>ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¥Ø±Ø´Ø§Ø¯Ø§Øª</label>
                <label style="display:flex;align-items:center;gap:8px"><input id="adviceToggle" type="checkbox"> <span>ØªØ´ØºÙŠÙ„ Ø§Ù„Ø¥Ø±Ø´Ø§Ø¯Ø§Øª</span></label>
              </div>
              <div class="field third"><label>Ù‚Ø§Ù„Ø¨ Ø¥Ø±Ø´Ø§Ø¯Ø§Øª</label>
                <select id="adviceTemplate" disabled>
                  <option value="">â€” Ø§Ø®ØªØ± Ù‚Ø§Ù„Ø¨Ù‹Ø§ â€”</option>
                  <option value="acne_care">Basic Acne Care</option>
                  <option value="laser_post">Laser Postâ€‘Care</option>
                  <option value="peel_after">Peel Afterâ€‘Care</option>
                </select>
              </div>
            </div>
            <div class="row">
              <div class="field full" id="adviceChipsWrap" aria-disabled="true">
                <div class="chip">ØªØ¬Ù†Ù‘Ø¨ Ø§Ù„Ø´Ù…Ø³ Ø§Ù„Ù…Ø¨Ø§Ø´Ø±</div>
                <div class="chip">SPF â‰¥ 50</div>
                <div class="chip">Ù…Ø±Ø·Ù‘Ø¨ ØµØ¨Ø§Ø­Ù‹Ø§/Ù…Ø³Ø§Ø¡Ù‹</div>
                <div class="chip">Ù…Ù†Ø¸Ù‘Ù Ù„Ø·ÙŠÙ</div>
              </div>
              <div class="field full"><label>ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©</label><textarea id="adviceText" placeholder="ØªØ¹Ù„ÙŠÙ…Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„Ø·Ø¨ÙŠØ¨â€¦" disabled></textarea></div>
            </div>
          </div>
        </div>
      </section>

      <!-- Labs & Files -->
      <section id="panel-labs" class="tabpanel" role="tabpanel" aria-labelledby="tab-labs" aria-hidden="true">
        <div class="grid">
          <div class="card">
            <div class="head"><h3>ğŸ§ª Ø§Ù„ØªØ­Ø§Ù„ÙŠÙ„ (Ù…ÙƒØ±Ø± Ù‚Ø§Ø¨Ù„ Ù„Ù„Ø¥Ø¶Ø§ÙØ©)</h3></div>
            <div class="body">
              <div class="uploader">Ø§Ø³Ø­Ø¨ Ù…Ù„Ù Ù†ØªÙŠØ¬Ø© (PDF/ØµÙˆØ±Ø©) Ø£Ùˆ Ø§Ø¶ØºØ· Ù„Ù„Ø§Ø®ØªÙŠØ§Ø±</div>
              <div style="margin-top:12px">
                <label>ØªØ­Ø§Ù„ÙŠÙ„ Ù‡Ø°Ù‡ Ø§Ù„Ø²ÙŠØ§Ø±Ø©</label>
                <div id="labRepeater">
                  <div class="lab-item" style="border:1px solid var(--line);border-radius:14px;padding:12px;margin-top:8px;background:#fff">
                    <div class="row">
                      <div class="field third"><label>Ø§Ø³Ù… Ø§Ù„ØªØ­Ù„ÙŠÙ„</label><input placeholder="CBC / LFTs / â€¦"></div>
                      <div class="field third"><label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</label><input placeholder="ØµÙŠØ§Ù…ØŒ ÙˆÙ‚ØªØŒ Ø¥Ù„Ø®"></div>
                      <div class="field third"><label>Ø±ÙØ¹ Ø§Ù„Ù†ØªÙŠØ¬Ø©</label><input type="file"></div>
                      <div class="field third"><label>Ø¨ÙŠØ§Ù† Ø§Ù„Ù…Ø¹Ù…Ù„</label><input value="Ø§Ù„Ù…Ø¹Ù…Ù„ : Ø§Ù„Ù‚ØµØ± Ø§Ù„Ø¹ÙŠÙ†ÙŠ"></div>
                      <div class="field quarter"><label>&nbsp;</label><button class="btn lab-remove" style="width:100%">Ø­Ø°Ù</button></div>
                    </div>
                  </div>
                </div>
                <button id="addLab" class="btn" style="margin-top:8px">+ Ø¥Ø¶Ø§ÙØ© ØªØ­Ù„ÙŠÙ„</button>
              </div>
            </div>
          </div>

          <aside class="card">
            <div class="head"><h3>ğŸ“ Ù…Ù„ÙØ§Øª Ù…Ø­ÙÙˆØ¸Ø©</h3></div>
            <div class="body">
              <table>
                <thead><tr><th>Ø§Ù„Ù…Ù„Ù</th><th>Ø§Ù„Ù†ÙˆØ¹</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø¥Ø¬Ø±Ø§Ø¡</th></tr></thead>
                <tbody>
                  <tr><td>CBC-Result-2025-09-02.pdf</td><td>PDF</td><td>02-09-2025</td><td><button class="btn">Ø¹Ø±Ø¶</button></td></tr>
                  <tr><td>lesion-closeup-1.jpg</td><td>ØµÙˆØ±Ø©</td><td>02-09-2025</td><td><button class="btn">Ø¹Ø±Ø¶</button></td></tr>
                </tbody>
              </table>
            </div>
          </aside>
        </div>
      </section>

      <!-- Photos -->
      <section id="panel-photos" class="tabpanel" role="tabpanel" aria-labelledby="tab-photos" aria-hidden="true">
        <div class="card">
          <div class="head"><h3>ğŸ“¸ ØµÙˆØ± Ø§Ù„Ø­Ø§Ù„Ø©</h3></div>
          <div class="body">
            <div class="hint" style="margin-bottom:8px">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ù…ÙˆØ§ÙÙ‚Ø© ØªØµÙˆÙŠØ± ÙˆØ§Ø¶Ø­Ø© Ù…Ù† Ø§Ù„Ù…Ø±ÙŠØ¶.</div>
            <div class="row">
              <div class="field full"><label>Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¹Ù„Ù‰ Ø§Ù„ØµÙˆØ±</label><input placeholder="Ù…Ø³Ø§ÙØ© 50Ø³Ù…ØŒ Ø¥Ø¶Ø§Ø¡Ø© Ù…ÙˆØ­Ù‘Ø¯Ø©ØŒ Ø²Ø§ÙˆÙŠØ© Ø£Ù…Ø§Ù…ÙŠØ©/Ø¬Ø§Ù†Ø¨ÙŠØ©"></div>
              <div class="field third"><div class="uploader">Ø¥Ø¶Ø§ÙØ© ØµÙˆØ±Ø©</div></div>
              <div class="field third"><div class="uploader">Ø¥Ø¶Ø§ÙØ© ØµÙˆØ±Ø©</div></div>
              <div class="field third"><div class="uploader">Ø¥Ø¶Ø§ÙØ© ØµÙˆØ±Ø©</div></div>
            </div>
          </div>
        </div>
      </section>

      <!-- Billing -->
      <section id="panel-billing" class="tabpanel" role="tabpanel" aria-labelledby="tab-billing" aria-hidden="true">
        <div class="grid">
          <div class="card">
            <div class="head"><h3>ğŸ’³ Ø§Ù„Ø®Ø¯Ù…Ø§Øª ÙˆØ§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</h3></div>
            <div class="body">
              <div class="hint">ÙŠÙ…ÙƒÙ† ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø³Ø¹Ø± ÙŠØ¯ÙˆÙŠÙ‹Ø§ Ù„ÙƒÙ„ Ø®Ø¯Ù…Ø©.</div>
              <div id="svcRepeater">
                <div class="svc-item" style="border:1px solid var(--line);border-radius:14px;padding:12px;margin-top:8px;background:#fff">
                  <div class="row">
                    <div class="field third"><label>Ø§Ù„Ø®Ø¯Ù…Ø©</label>
                      <select class="svc-select">
                        <option value="consult" data-price="300">ÙƒØ´Ù Ø¬Ù„Ø¯ÙŠØ©</option>
                        <option value="laser_small" data-price="500">Ø¬Ù„Ø³Ø© Ù„ÙŠØ²Ø± (Ù…Ù†Ø·Ù‚Ø© ØµØºÙŠØ±Ø©)</option>
                        <option value="peel_light" data-price="400">ØªÙ‚Ø´ÙŠØ± ÙƒÙŠÙ…ÙŠØ§Ø¦ÙŠ Ø®ÙÙŠÙ</option>
                        <option value="dermapen" data-price="600">Dermapen</option>
                        <option value="other" data-price="0">Ø®Ø¯Ù…Ø© Ø£Ø®Ø±Ù‰â€¦</option>
                      </select>
                    </div>
                    <div class="field quarter"><label>Ø§Ù„Ø³Ø¹Ø± (Ø¬Ù†ÙŠÙ‡)</label><input class="svc-price" type="number" value="300" min="0" step="1"></div>
                    <div class="field quarter"><label>Ø§Ù„ÙƒÙ…ÙŠØ©</label><input class="svc-qty" type="number" value="1" min="1" step="1"></div>
                    <div class="field quarter"><label>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¨Ù†Ø¯</label><div class="chip"><strong class="line-total">EGP 300.00</strong></div></div>
                    <div class="field quarter"><label>&nbsp;</label><button class="btn svc-remove" style="width:100%">Ø­Ø°Ù</button></div>
                  </div>
                </div>
              </div>
              <button id="addSvc" class="btn" style="margin-top:8px">+ Ø¥Ø¶Ø§ÙØ© Ø®Ø¯Ù…Ø©</button>
            </div>
          </div>

          <aside class="card">
            <div class="head"><h3>ğŸ§¾ Ø§Ù„Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ø§Ù„ÙŠ</h3></div>
            <div class="body">
              <div class="row">
                <div class="field third"><label>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</label><select><option>Ù†Ù‚Ø¯ÙŠ</option><option>Ø¨Ø·Ø§Ù‚Ø©</option><option>ØªØ­ÙˆÙŠÙ„</option></select></div>
                <div class="field third"><label>Ø³Ø¨Ø¨ Ø§Ù„Ø®ØµÙ…</label><input id="discReason" placeholder="Ø¹Ø±Ø¶/ÙƒÙˆØ¨ÙˆÙ†/ÙˆÙ„Ø§Ø¡"></div>
                <div class="field quarter"><label>Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®ØµÙ…</label><input id="discInput" type="number" value="0" min="0" step="1"></div>
                <div class="field quarter"><label>Ø¶Ø±ÙŠØ¨Ø©/Ø±Ø³ÙˆÙ…</label><input id="taxInput" type="number" value="0" min="0" step="1"></div>
              </div>
              <div class="totals">
                <div class="line"><span>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</span><strong id="subtotalVal">EGP 0.00</strong></div>
                <div class="line"><span>Ø®ØµÙ…</span><strong id="discountVal">EGP 0.00</strong></div>
                <div class="line"><span>Ø¶Ø±ÙŠØ¨Ø©</span><strong id="taxVal">EGP 0.00</strong></div>
                <div class="line grand"><span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</span><span id="totalVal">EGP 0.00</span></div>
              </div>
              <div class="row" style="margin-top:12px">
                <div class="field third"><button class="btn">Ø¥ØµØ¯Ø§Ø± ÙØ§ØªÙˆØ±Ø©</button></div>
                <div class="field third"><button class="btn primary">ØªØ­ØµÙŠÙ„ Ø§Ù„Ø¢Ù†</button></div>
              </div>
            </div>
          </aside>
        </div>
      </section>

    </div>

    <div class="actions no-print" style="justify-content:flex-end;margin-top:16px">
      <button class="btn">Ø­ÙØ¸ Ù…Ø³ÙˆØ¯Ø©</button>
      <button class="btn primary">Ø­ÙØ¸ Ø§Ù„Ø²ÙŠØ§Ø±Ø©</button>
    </div>
  </main>

<script>
  // Tabs
  const tabs = document.querySelectorAll('[role="tab"]');
  const panels = document.querySelectorAll('[role="tabpanel"]');
  function activateTab(tab){
    tabs.forEach(t=> t.setAttribute('aria-selected','false'));
    panels.forEach(p=> p.setAttribute('aria-hidden','true'));
    tab.setAttribute('aria-selected','true');
    document.getElementById(tab.getAttribute('aria-controls')).setAttribute('aria-hidden','false');
  }
  tabs.forEach(t=> t.addEventListener('click', ()=> activateTab(t)));

  // Skin types selector
  (function(){
    const wrap = document.getElementById('skinTypes');
    const input = document.getElementById('skinTypeInput');
    if(!wrap) return;
    wrap.querySelectorAll('.skin-card').forEach(card=>{
      card.addEventListener('click', ()=>{
        wrap.querySelectorAll('.skin-card').forEach(c=>c.classList.remove('active'));
        card.classList.add('active');
        input.value = card.dataset.value;
      });
    });
  })();

  // BodyPicker (image + hotspots) â€” ØªØ®Ø²ÙŠÙ† JSON Ø¨Ù‡ÙˆÙŠØ§Øª ÙØ±ÙŠØ¯Ø©
  (function(){
    const picker = document.getElementById('BodyPicker');
    const hidden = document.getElementById('locationsInput');
    if(!picker || !hidden) return;

    // Ù†Ù‚Ø§Ø· Ø¯Ù‚ÙŠÙ‚Ø© Ù„Ù„ØµÙˆØ±Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ© (Front/Back)
    const spots = [
      // ===== FRONT â€“ HEAD DETAIL =====
      {id:'front_scalp', key:'Ø±Ø£Ø³ Ø¹Ù„ÙˆÙŠ Ø§Ù…Ø§Ù…ÙŠ', tip:'Scalp', x:23, y:31, view:'front'},
      {id:'front_forehead', key:'Ø¬Ø¨ÙŠÙ†', tip:'Forehead', x:23, y:33.1, view:'front'},
      {id:'front_cheek_r', key:'Ø®Ø¯ ÙŠÙ…ÙŠÙ†', tip:'Right Cheek', x:20, y:37, view:'front'},
      {id:'front_cheek_l', key:'Ø®Ø¯ ÙŠØ³Ø§Ø±', tip:'Left Cheek', x:26, y:37, view:'front'},
      {id:'front_nose', key:'Ø£Ù†Ù', tip:'Nose', x:50, y:13.4, view:'front'},
      {id:'front_lips', key:'Ø´ÙØ§Ù‡', tip:'Lips', x:50, y:18.6, view:'front'},
      {id:'front_chin', key:'Ø°Ù‚Ù†', tip:'Chin', x:50, y:21.4, view:'front'},
      {id:'front_ear_r', key:'Ø£Ø°Ù† ÙŠÙ…ÙŠÙ†', tip:'Right Ear', x:39, y:13.2, view:'front'},
      {id:'front_ear_l', key:'Ø£Ø°Ù† ÙŠØ³Ø§Ø±', tip:'Left Ear', x:61, y:13.2, view:'front'},

      // ===== FRONT â€“ TORSO =====
      {id:'front_neck', key:'Ø±Ù‚Ø¨Ø©', x:50, y:23.0, view:'front'},
      {id:'front_shoulder_r', key:'ÙƒØªÙ ÙŠÙ…ÙŠÙ†', x:33, y:25.0, view:'front'},
      {id:'front_shoulder_l', key:'ÙƒØªÙ ÙŠØ³Ø§Ø±', x:67, y:25.0, view:'front'},
      {id:'front_chest', key:'ØµØ¯Ø±', x:50, y:28.0, view:'front'},
      {id:'front_abdomen', key:'Ø¨Ø·Ù†', x:50, y:38.0, view:'front'},
      {id:'front_pelvis', key:'Ø­ÙˆØ¶', x:50, y:46.0, view:'front'},

      // ===== FRONT â€“ ARMS & HANDS =====
      {id:'front_upperarm_r', key:'Ø°Ø±Ø§Ø¹ Ø¹Ù„ÙˆÙŠ ÙŠÙ…ÙŠÙ†', x:27.5, y:36.5, view:'front'},
      {id:'front_upperarm_l', key:'Ø°Ø±Ø§Ø¹ Ø¹Ù„ÙˆÙŠ ÙŠØ³Ø§Ø±', x:72.5, y:36.5, view:'front'},
      {id:'front_forearm_r', key:'Ø³Ø§Ø¹Ø¯ ÙŠÙ…ÙŠÙ†', x:23.5, y:45.5, view:'front'},
      {id:'front_forearm_l', key:'Ø³Ø§Ø¹Ø¯ ÙŠØ³Ø§Ø±', x:76.5, y:45.5, view:'front'},

      {id:'front_palm_r', key:'ÙƒÙ ÙŠÙ…ÙŠÙ†', x:18.5, y:58.5, view:'front'},
      {id:'front_thumb_r', key:'Ø¥Ø¨Ù‡Ø§Ù… ÙŠÙ…ÙŠÙ†', x:21.3, y:57.0, view:'front'},
      {id:'front_index_r', key:'Ø³Ø¨Ø§Ø¨Ø© ÙŠÙ…ÙŠÙ†', x:16.6, y:56.8, view:'front'},
      {id:'front_middle_r', key:'ÙˆØ³Ø·Ù‰ ÙŠÙ…ÙŠÙ†', x:15.8, y:57.6, view:'front'},
      {id:'front_ring_r', key:'Ø¨Ù†ØµØ± ÙŠÙ…ÙŠÙ†', x:15.1, y:58.8, view:'front'},
      {id:'front_little_r', key:'Ø®Ù†ØµØ± ÙŠÙ…ÙŠÙ†', x:15.6, y:60.0, view:'front'},

      {id:'front_palm_l', key:'ÙƒÙ ÙŠØ³Ø§Ø±', x:81.5, y:58.5, view:'front'},
      {id:'front_thumb_l', key:'Ø¥Ø¨Ù‡Ø§Ù… ÙŠØ³Ø§Ø±', x:78.7, y:57.0, view:'front'},
      {id:'front_index_l', key:'Ø³Ø¨Ø§Ø¨Ø© ÙŠØ³Ø§Ø±', x:83.4, y:56.8, view:'front'},
      {id:'front_middle_l', key:'ÙˆØ³Ø·Ù‰ ÙŠØ³Ø§Ø±', x:84.2, y:57.6, view:'front'},
      {id:'front_ring_l', key:'Ø¨Ù†ØµØ± ÙŠØ³Ø§Ø±', x:84.9, y:58.8, view:'front'},
      {id:'front_little_l', key:'Ø®Ù†ØµØ± ÙŠØ³Ø§Ø±', x:84.4, y:60.0, view:'front'},

      // ===== FRONT â€“ LEGS & FEET =====
      {id:'front_thigh_r', key:'ÙØ®Ø° ÙŠÙ…ÙŠÙ†', x:44, y:55.5, view:'front'},
      {id:'front_thigh_l', key:'ÙØ®Ø° ÙŠØ³Ø§Ø±', x:56, y:55.5, view:'front'},
      {id:'front_knee_r', key:'Ø±ÙƒØ¨Ø© ÙŠÙ…ÙŠÙ†', x:44, y:65.8, view:'front'},
      {id:'front_knee_l', key:'Ø±ÙƒØ¨Ø© ÙŠØ³Ø§Ø±', x:56, y:65.8, view:'front'},
      {id:'front_leg_r', key:'Ø³Ø§Ù‚ ÙŠÙ…ÙŠÙ†', x:44, y:76.0, view:'front'},
      {id:'front_leg_l', key:'Ø³Ø§Ù‚ ÙŠØ³Ø§Ø±', x:56, y:76.0, view:'front'},

      {id:'front_heel_r', key:'ÙƒØ¹Ø¨ ÙŠÙ…ÙŠÙ†', x:45, y:90.2, view:'front'},
      {id:'front_dorsum_r', key:'ÙˆØ´ Ø§Ù„Ù‚Ø¯Ù… ÙŠÙ…ÙŠÙ†', x:45, y:87.2, view:'front'},
      {id:'front_sole_r', key:'Ø£Ø³ÙÙ„ Ø§Ù„Ù‚Ø¯Ù… ÙŠÙ…ÙŠÙ†', x:45, y:93.4, view:'front'},
      {id:'front_toes_r', key:'Ø£ØµØ§Ø¨Ø¹ Ø§Ù„Ù‚Ø¯Ù… ÙŠÙ…ÙŠÙ†', x:45, y:95.4, view:'front'},

      {id:'front_heel_l', key:'ÙƒØ¹Ø¨ ÙŠØ³Ø§Ø±', x:55, y:90.2, view:'front'},
      {id:'front_dorsum_l', key:'ÙˆØ´ Ø§Ù„Ù‚Ø¯Ù… ÙŠØ³Ø§Ø±', x:55, y:87.2, view:'front'},
      {id:'front_sole_l', key:'Ø£Ø³ÙÙ„ Ø§Ù„Ù‚Ø¯Ù… ÙŠØ³Ø§Ø±', x:55, y:93.4, view:'front'},
      {id:'front_toes_l', key:'Ø£ØµØ§Ø¨Ø¹ Ø§Ù„Ù‚Ø¯Ù… ÙŠØ³Ø§Ø±', x:55, y:95.4, view:'front'},

      // ===== BACK (ØªÙ‚Ø±ÙŠØ¨ÙŠØ© Ø­Ø§Ù„ÙŠØ§Ù‹) =====
      {id:'back_scalp', key:'Ø±Ø£Ø³ Ø¹Ù„ÙˆÙŠ', x:50, y:6.5, view:'back'},
      {id:'back_neck', key:'Ø±Ù‚Ø¨Ø©', x:50, y:13.0, view:'back'},
      {id:'back_shoulder_r', key:'ÙƒØªÙ ÙŠÙ…ÙŠÙ†', x:33, y:25.0, view:'back'},
      {id:'back_shoulder_l', key:'ÙƒØªÙ ÙŠØ³Ø§Ø±', x:67, y:25.0, view:'back'},
      {id:'back_upperback', key:'Ø¸Ù‡Ø± Ø¹Ù„ÙˆÙŠ', x:50, y:28.5, view:'back'},
      {id:'back_lowerback', key:'Ø¸Ù‡Ø± Ø³ÙÙ„ÙŠ', x:50, y:38.5, view:'back'},
      {id:'back_gluteal', key:'Ø£Ø±Ø¯Ø§Ù', x:50, y:46.5, view:'back'},
      {id:'back_upperarm_r', key:'Ø°Ø±Ø§Ø¹ Ø¹Ù„ÙˆÙŠ ÙŠÙ…ÙŠÙ†', x:27.5, y:36.5, view:'back'},
      {id:'back_upperarm_l', key:'Ø°Ø±Ø§Ø¹ Ø¹Ù„ÙˆÙŠ ÙŠØ³Ø§Ø±', x:72.5, y:36.5, view:'back'},
      {id:'back_forearm_r', key:'Ø³Ø§Ø¹Ø¯ ÙŠÙ…ÙŠÙ†', x:23.5, y:45.5, view:'back'},
      {id:'back_forearm_l', key:'Ø³Ø§Ø¹Ø¯ ÙŠØ³Ø§Ø±', x:76.5, y:45.5, view:'back'},
      {id:'back_palm_r', key:'ÙƒÙ ÙŠÙ…ÙŠÙ†', x:18.5, y:58.5, view:'back'},
      {id:'back_palm_l', key:'ÙƒÙ ÙŠØ³Ø§Ø±', x:81.5, y:58.5, view:'back'},
      {id:'back_thigh_r', key:'ÙØ®Ø° ÙŠÙ…ÙŠÙ†', x:44, y:55.5, view:'back'},
      {id:'back_thigh_l', key:'ÙØ®Ø° ÙŠØ³Ø§Ø±', x:56, y:55.5, view:'back'},
      {id:'back_knee_r', key:'Ø±ÙƒØ¨Ø© ÙŠÙ…ÙŠÙ†', x:44, y:65.8, view:'back'},
      {id:'back_knee_l', key:'Ø±ÙƒØ¨Ø© ÙŠØ³Ø§Ø±', x:56, y:65.8, view:'back'},
      {id:'back_leg_r', key:'Ø³Ø§Ù‚ ÙŠÙ…ÙŠÙ†', x:44, y:76.0, view:'back'},
      {id:'back_leg_l', key:'Ø³Ø§Ù‚ ÙŠØ³Ø§Ø±', x:56, y:76.0, view:'back'},
      {id:'back_heel_r', key:'ÙƒØ¹Ø¨ ÙŠÙ…ÙŠÙ†', x:45, y:90.2, view:'back'},
      {id:'back_heel_l', key:'ÙƒØ¹Ø¨ ÙŠØ³Ø§Ø±', x:55, y:90.2, view:'back'},
      {id:'back_toes_r', key:'Ø£ØµØ§Ø¨Ø¹ Ø§Ù„Ù‚Ø¯Ù… ÙŠÙ…ÙŠÙ†', x:45, y:95.4, view:'back'},
      {id:'back_toes_l', key:'Ø£ØµØ§Ø¨Ø¹ Ø§Ù„Ù‚Ø¯Ù… ÙŠØ³Ø§Ø±', x:55, y:95.4, view:'back'}
    ];

    // Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù‡ÙˆØª-Ø³Ø¨ÙˆØªØ³
    const frag = document.createDocumentFragment();
    spots.forEach(s=>{
      const b = document.createElement('button');
      b.type = 'button';
      b.className = 'bp-spot';
      b.dataset.id   = s.id;
      b.dataset.key  = s.key;
      b.dataset.view = s.view;
      b.dataset.tip  = s.key;
      b.style.left = s.x + '%';
      b.style.top  = s.y + '%';
      b.hidden = (s.view !== picker.dataset.view);
      b.addEventListener('click', ()=>{ b.classList.toggle('active'); sync(); });
      frag.appendChild(b);
    });
    picker.appendChild(frag);

    // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø£Ù…Ø§Ù…ÙŠ/Ø§Ù„Ø®Ù„ÙÙŠ
    document.querySelectorAll('.bp-toggle').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        document.querySelectorAll('.bp-toggle').forEach(x=>x.classList.remove('active'));
        btn.classList.add('active');
        picker.dataset.view = btn.dataset.view;
        picker.querySelectorAll('.bp-spot').forEach(s=>{
          s.hidden = (s.dataset.view !== picker.dataset.view);
        });
      });
    });

    // Ù…Ø²Ø§Ù…Ù†Ø© Ø§Ù„Ù…Ø¯Ø®Ù„ Ø§Ù„Ù…Ø®ÙÙŠ: JSON (id/key/view)
    function sync(){
      const sel = [...picker.querySelectorAll('.bp-spot.active')].map(el=>({
        id: el.dataset.id,
        key: el.dataset.key,
        view: el.dataset.view
      }));
      hidden.value = JSON.stringify(sel);
    }
  })();

  // Labs repeater
  (function(){
    const wrap = document.getElementById('labRepeater');
    const addBtn = document.getElementById('addLab');
    if(!wrap || !addBtn) return;
    addBtn.addEventListener('click', ()=>{
      const first = wrap.querySelector('.lab-item');
      const item = first.cloneNode(true);
      item.querySelectorAll('input').forEach(inp=>{
        if(inp.type==='file'){ try{inp.value=null;}catch(e){} }
        else{
          if(inp.previousElementSibling?.tagName==='LABEL'
             && inp.previousElementSibling.textContent.includes('Ø¨ÙŠØ§Ù† Ø§Ù„Ù…Ø¹Ù…Ù„')){
            inp.value='Ø§Ù„Ù…Ø¹Ù…Ù„ : Ø§Ù„Ù‚ØµØ± Ø§Ù„Ø¹ÙŠÙ†ÙŠ';
          }else{
            inp.value='';
          }
        }
      });
      wrap.appendChild(item);
    });
    wrap.addEventListener('click', (e)=>{
      const btn = e.target.closest('.lab-remove'); if(!btn) return;
      const items = wrap.querySelectorAll('.lab-item');
      if(items.length>1){ btn.closest('.lab-item').remove(); }
    });
  })();

  // Services repeater + totals
  (function(){
    const wrap = document.getElementById('svcRepeater');
    const addBtn = document.getElementById('addSvc');
    const subtotalEl = document.getElementById('subtotalVal');
    const discountEl = document.getElementById('discountVal');
    const taxEl = document.getElementById('taxVal');
    const totalEl = document.getElementById('totalVal');
    const discInput = document.getElementById('discInput');
    const taxInput  = document.getElementById('taxInput');
    const fmt = n => 'EGP ' + (isFinite(n)? Number(n).toFixed(2) : '0.00');

    function recalc(){
      let subtotal = 0;
      wrap.querySelectorAll('.svc-item').forEach(it=>{
        const price = parseFloat(it.querySelector('.svc-price').value||0);
        const qty   = parseInt(it.querySelector('.svc-qty').value||1);
        const line  = (isFinite(price)&&isFinite(qty)) ? price*qty : 0;
        subtotal += line;
        const lineEl = it.querySelector('.line-total'); 
        if(lineEl) lineEl.textContent = fmt(line);
      });
      const discount = parseFloat(discInput?.value||0);
      const tax      = parseFloat(taxInput?.value||0);
      subtotalEl.textContent = fmt(subtotal);
      discountEl.textContent = fmt(discount);
      taxEl.textContent      = fmt(tax);
      totalEl.textContent    = fmt(subtotal - discount + tax);
    }

    function bindItem(it){
      const sel  = it.querySelector('.svc-select');
      const priceInput = it.querySelector('.svc-price');
      const qtyInput   = it.querySelector('.svc-qty');
      sel.addEventListener('change', ()=>{
        const p = parseFloat(sel.selectedOptions[0].getAttribute('data-price')||0);
        priceInput.value = isFinite(p)? p : 0;
        recalc();
      });
      priceInput.addEventListener('input', recalc);
      qtyInput.addEventListener('input', recalc);
      it.querySelector('.svc-remove').addEventListener('click', ()=>{
        const items = wrap.querySelectorAll('.svc-item');
        if(items.length>1){ it.remove(); recalc(); }
      });
    }

    wrap.querySelectorAll('.svc-item').forEach(bindItem);

    addBtn.addEventListener('click', ()=>{
      const first = wrap.querySelector('.svc-item');
      const item  = first.cloneNode(true);
      item.querySelector('.svc-select').selectedIndex = 0;
      item.querySelector('.svc-price').value = first.querySelector('.svc-select').selectedOptions[0].getAttribute('data-price') || 300;
      item.querySelector('.svc-qty').value   = 1;
      wrap.appendChild(item);
      bindItem(item);
      recalc();
    });

    discInput?.addEventListener('input', recalc);
    taxInput?.addEventListener('input', recalc);
    recalc();
  })();
</script>

</body>
</html>
